events {
    worker_connections 1024;
}

http {
    # Minimal settings for testing
    sendfile on;
    keepalive_timeout 65;
    
    # Logging
    access_log /var/log/nginx/access.log;
    error_log /var/log/nginx/error.log;
    
    # HTTP server for testing
    server {
        listen 80;
        server_name _;
        
        # Health check endpoint
        location /health {
            access_log off;
            return 200 "nginx-ok\n";
            add_header Content-Type text/plain;
        }
        
        # HTTP to HTTPS redirect (tạm thời vô hiệu hóa cho testing)
        location / {
            return 200 "nginx-http-ok\n";
            add_header Content-Type text/plain;
        }
    }
    
    # HTTPS placeholder (chỉ HTTP cho testing đơn giản)
    # server {
    #     listen 443 ssl http2 default_server;
    #     server_name _;
    #     
    #     # Self-signed cert for testing (replace with real cert later)
    #     ssl_certificate /etc/ssl/certs/ssl-cert-snakeoil.pem;
    #     ssl_certificate_key /etc/ssl/private/ssl-cert-snakeoil.key;
    #     ssl_protocols TLSv1.2 TLSv1.3;
    #     
    #     # Basic security headers
    #     add_header X-Frame-Options DENY;
    #     add_header X-Content-Type-Options nosniff;
    #     
    #     location /health {
    #         access_log off;
    #         return 200 "nginx-ssl-ok\n";
    #         add_header Content-Type text/plain;
    #     }
    #     
    #     location / {
    #         return 444; # Close connection
    #     }
    # }
}
